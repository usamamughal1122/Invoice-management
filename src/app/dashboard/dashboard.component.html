<div class="dashboard-wrapper container-fluid px-4 py-4">

  <!-- HEADER -->
  <div class="header-section d-flex justify-content-between align-items-center flex-wrap gap-3 mb-4">
    <div>
      <h4 class="fw-bold text-dark mb-0">Inventory Management</h4>
      <small class="text-muted">Overview of assets, usage, and employees</small>
    </div>
    <button class="btn btn-outline-primary btn-sm" (click)="reloadDashboard()">
      <i class="bi bi-arrow-clockwise me-1"></i> Refresh
    </button>
  </div>

  <!-- TOP SUMMARY CARDS -->
  <div class="row g-4 mb-4">
    <!-- Total Assets -->
    <div class="col-md-6 col-lg-3">
      <div class="summary-card card-primary">
        <div class="card-icon"><i class="bi bi-box-seam"></i></div>
        <div class="card-content">
          <h6 class="card-label">Total Stock</h6>
          <h2 class="card-value">{{ dashboardList.length || 0 }}</h2>
          <p class="card-description">All registered inventory items</p>
        </div>
      </div>
    </div>

    <!-- Available -->
    <div class="col-md-6 col-lg-3">
      <div class="summary-card card-info">
        <div class="card-icon"><i class="bi bi-box"></i></div>
        <div class="card-content">
          <h6 class="card-label">Available Stock</h6>
          <h2 class="card-value">{{ countStatus('Available') }}</h2>
          <p class="card-description">Ready for assignment</p>
        </div>
      </div>
    </div>

   <!-- Un Avaialable -->
    <div class="col-md-6 col-lg-3">
      <div class="summary-card card-success">
        <div class="card-icon"><i class="bi bi-people"></i></div>
        <div class="card-content">
          <h6 class="card-label">UnAvaiable</h6>
          <h2 class="card-value">{{ countStatus('UnAvailable') }}</h2>
          <p class="card-description">Items currently in use</p>
        </div>
      </div>
    </div>
    
    <!-- Under Repair -->
    <div class="col-md-6 col-lg-3">
      <div class="summary-card card-warning">
        <div class="card-icon"><i class="bi bi-tools"></i></div>
        <div class="card-content">
          <h6 class="card-label">Under Maintenance</h6>
          <h2 class="card-value">{{ countStatus('Repair') }}</h2>
          <p class="card-description">Currently being serviced</p>
        </div>
      </div>
    </div>
  </div>

  <!-- TOP 20 PRODUCTS -->
  <div class="modern-card mb-4 shadow-sm" *ngIf="dashboardList.length > 0">
    <div class="modern-card-header d-flex justify-content-between align-items-center">
      <span><i class="bi bi-star me-2"></i>Top Products</span>
      <button class="btn btn-refresh btn-sm" (click)="reloadTopProducts()">
        <i class="bi bi-arrow-clockwise"></i> Refresh
      </button>
    </div>

    <div class="table-responsive">
      <table class="modern-table table mb-0 align-middle">
        <thead>
          <tr>
            <th style="width: 5%">#</th>
            <th style="width: 20%">Name</th>
            <th style="width: 15%">Brand</th>
            <th style="width: 15%">Category</th>
            <th style="width: 10%">Qty (Avail/Total)</th>
            <th style="width: 15%">Supplier</th>
            <th style="width: 15%">Status</th>
            <th style="width: 15%">Last Updated</th>
            <th style="width: 10%">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of topProducts| slice:0:5; let i = index" class="table-row-hover">
            <td>{{ i + 1 }}</td>
            <td><strong>{{ item.name }}</strong></td>
            <td>{{ item.brand?.brand }}</td>
            <td>{{item.category?.category }}</td>
            <td>{{ item.quantity_available }}/{{ item.quantity_total }}</td>
            <td>{{ item.supplier?.name }}</td>
            <td>
              <span class="modern-badge"
                [ngClass]="{
                  'badge-success': item.status === 'Available',
                  'badge-primary': item.status === 'UnAvailable',
                  'badge-warning': item.status === 'Repair',
                  'badge-secondary': item.status === 'Retired',
                  'badge-danger': item.status === 'Lost'
                }">
                {{ item.status }}
              </span>
            </td>
            <td>{{ item.updatedAt | date:'mediumDate' }}</td>
            <td>
              <button class="btn-view btn-sm" (click)="viewItem(item)">
                <i class="bi bi-eye"></i> View
              </button>
            </td>
          </tr>
          <tr *ngIf="dashboardList.length === 0">
            <td colspan="8">
              <div class="empty-state">
                <i class="bi bi-inbox"></i>
                <p>No products found</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- BOTTOM SECTION -->
  <div class="row g-4">
    <!-- RECENT INVENTORY -->
    <div class="col-lg-6 col-md-12">
      <div class="modern-card h-100 shadow-sm">
        <div class="modern-card-header">
          <span><i class="bi bi-clock-history me-2"></i>Recent Inventory</span>
        </div>
        <div class="table-responsive">
          <table class="modern-table table mb-0 align-middle">
            <thead>
              <tr>
                <th>#</th>
                <th>Name</th>
                <th>Status</th>
                <th>Available Stock</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of dashboardList | slice:0:5; let i = index" class="table-row-hover">
                <td>{{ i + 1 }}</td>
                <td><strong>{{ item.name }}</strong></td>
                <td>
                  <span class="modern-badge"
                    [ngClass]="{
                      'badge-success': item.status === 'Available',
                      'badge-primary': item.status === 'UnAvailable',
                      'badge-warning': item.status === 'Repair',
                      'badge-secondary': item.status === 'Retired',
                      'badge-danger': item.status === 'Lost'
                    }">
                    {{ item.status }}
                  </span>
                </td>
                <td>{{ item.quantity_available }}</td>
              </tr>
              <tr *ngIf="dashboardList.length === 0">
                <td colspan="5">
                  <div class="empty-state">
                    <i class="bi bi-inbox"></i>
                    <p>No recent inventory</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- EMPLOYEE OVERVIEW -->
    <div class="col-lg-6 col-md-12">
      <div class="modern-card h-100 shadow-sm">
        <div class="modern-card-header">
          <span><i class="bi bi-people me-2"></i>Employee Overview</span>
        </div>
        <div class="table-responsive">
          <table class="modern-table table mb-0 align-middle">
            <thead>
              <tr>
                <th>#</th>
                <th>Name</th>
                <th>Department</th>
                <th>Designation</th>
                <th>Salary</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let emp of recentRequests | slice:0:5; let i = index" class="table-row-hover">
                <td>{{ i + 1 }}</td>
                <td><strong>{{ emp.name }}</strong></td>
                <td>{{ emp.department }}</td>
                <td>{{ emp.designation }}</td>
                <td>{{ emp.salary | currency:'PKR':'symbol':'1.0-0' }}</td>
                <td>
                  <span class="modern-badge"
                    [ngClass]="emp.active ? 'badge-success' : 'badge-danger'">
                    {{ emp.active ? 'Active' : 'Inactive' }}
                  </span>
                </td>
              </tr>
              <tr *ngIf="recentRequests.length === 0">
                <td colspan="6">
                  <div class="empty-state">
                    <i class="bi bi-inbox"></i>
                    <p>No employee data available</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Hidden component to fetch employee data -->
<app-session-list (employeList)="AllEmployes($event)" style="display: none"></app-session-list>
<ngx-spinner
  bdColor="rgba(256, 256, 256, 0.8)"
  size="large"
  color="#fff"
  type="ball-scale-multiple"
  [fullScreen]="true"
    template="<img src='assets/stockify.png' />"

>
  <!-- Centered Logo -->
  <div class="spinner-logo" *ngIf="isLoading">
    
    <img src="data:image/png;base64,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" class="centered-logo" />
  </div>
</ngx-spinner>
