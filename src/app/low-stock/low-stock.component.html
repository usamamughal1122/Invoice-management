<div class="container-fluid margin-top">
    <!-- üî• Top Summary Section -->
  <div class="row mb-3">
    <div class="col-lg-12">
      <div class="summary-box p-3 rounded shadow d-flex justify-content-between align-items-center">

        <div>
          <h4 class="text-gold mb-1">üìâ Low Stock Overview</h4>
          <small class="text-muted">Last updated: {{ today | date:'short' }}</small>
        </div>

        <div class="d-flex gap-3">

          <div class="info-pill">
            <span class="label">Low Stock Items</span>
            <span class="value">{{ items.length }}</span>
          </div>

          <div class="info-pill">
            <span class="label">Filter</span>
            <span class="value">Low Stock Active</span>
          </div>

          <button class="btn btn-gold" (click)="loadQty()">
            üîÑ Refresh
          </button>

        </div>

      </div>
    </div>
  </div>

  <div class="card lowstock-card shadow">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0 text-gold">‚ö†Ô∏è Low Stock</h5>
      <span class="badge bg-black text-gold">{{ items.length }} Items</span>
    </div>

    <div class="card-body table-responsive">
      <table class="table table-hover align-middle text-white">
        <thead>
          <tr class="gold-border">
            <th>#</th>
            <th>Item</th>
            <th>Category</th>
            <th>Brand</th>
            <th>SKU</th>
            <th>Price</th>
            <th>Supplier</th>
            <th>Qty</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let item of items; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.category?.category }}</td>
            <td>{{ item.brand?.brand }}</td>
            <td>{{ item.sku }}</td>
            <td>{{ item.price }}</td>
            <td>{{ item.supplier?.name }}</td>
            <td>
             <span class="qty-badge">{{ item.quantity_available }}</span>
            </td>

            <td class="text-end">
              <button 
                class="btn btn-sm btn-gold me-2"
                data-bs-toggle="modal" 
                data-bs-target="#editQtyModal"
                (click)="openEditModal(item)">
                Edit
              </button>

              <button 
                class="btn btn-sm btn-outline-danger"
                (click)="deleteItem(item._id)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<!--  Right Side Edit Quantity Modal -->
<div class="modal fade" id="editQtyModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-end">
    <div class="modal-content black-bg text-white">

      <div class="modal-header gold-border">
        <h5 class="modal-title text-gold">Update Stock</h5>

        <!-- Auto Close -->
        <button 
          type="button" 
          class="btn-close btn-close-white" 
          data-bs-dismiss="modal">
        </button>
      </div>

      <div class="modal-body">
        <label class="form-label">Quantity</label>
        <input type="number"
               class="form-control black-input"
               [(ngModel)]="newQty">
      </div>

      <div class="modal-footer">

        <!-- Auto Close After Update -->
        <button 
          class="btn btn-gold w-100"
          (click)="updateQty()"
          data-bs-dismiss="modal">
          Update Quantity
        </button>

      </div>

    </div>
  </div>
</div>

<ngx-spinner bdColor="rgba(256, 256, 256, 0.8)" size="large" color="#fff" type="ball-scale-multiple" [fullScreen]="true"
  template="<img src='assets/stockify.png' />">
</ngx-spinner>